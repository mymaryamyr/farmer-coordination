{"version":3,"sources":["UI/Input.module.css","UI/Button.module.css","UI/Info.module.css","UI/MapContainer.module.css","hooks/use-input.js","UI/Button.js","UI/Info.js","App.js","index.js"],"names":["module","exports","useInput","validationRule","useState","input","setInput","InputIsTouched","setInputIsTouched","inputIsValid","inputHasError","inputChange","e","target","value","inputBlur","reset","Button","props","className","classes","button","onClick","children","Info","info","App","submitLoading","seSubmitLoading","didSubmit","setDidSubmit","tryAgain","setTryAgain","notEmpty","length","name","nameIsValid","nameHasError","nameChange","nameBlur","resetName","date","dateIsValid","dateHasError","dateChange","dateBlur","resetDate","mapContainer","useRef","coordinates","setCoordinates","coordinatesHasError","setCoordinatesHasError","mapboxgl","accessToken","useEffect","map","Map","container","current","style","center","zoom","addControl","NavigationControl","draw","MapboxDraw","displayControlsDefault","controls","polygon","trash","defaultMode","on","x","getAll","remove","isSubmittingForm","submitedForm","type","window","location","reload","formContent","onSubmit","preventDefault","userData","fetch","method","headers","body","JSON","stringify","then","res","json","error","catch","console","inputClasses","form","input__block","form_group","htmlFor","control_label","onChange","onBlur","form_control","mapClasses","map__block","description","ref","trySubmittingAgain","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f16590e3.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"input__block\":\"Input_input__block__1lmOz\",\"form\":\"Input_form__1Qndy\",\"form_group\":\"Input_form_group__3SkNv\",\"control_label\":\"Input_control_label__2DGJF\",\"form_control\":\"Input_form_control__5jAch\",\"invalid\":\"Input_invalid__1ow-R\",\"error\":\"Input_error__16qd2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button___4jJN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"info\":\"Info_info__1XNHn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"map__block\":\"MapContainer_map__block__Rsesk\",\"error\":\"MapContainer_error__3jNSm\",\"mapContainer\":\"MapContainer_mapContainer__24UpN\",\"description\":\"MapContainer_description__2mlAg\"};","import { useState } from \"react\"\r\n\r\nconst useInput = (validationRule) => {\r\n    const [input, setInput] = useState('')\r\n    const [InputIsTouched, setInputIsTouched] = useState(false)\r\n\r\n    const inputIsValid = validationRule(input)\r\n    let inputHasError = InputIsTouched && !inputIsValid\r\n\r\n    const inputChange = (e) => {\r\n        setInput(e.target.value)\r\n    }\r\n    const inputBlur = (e) => {\r\n        setInputIsTouched(true)\r\n    }\r\n    const reset = () => {\r\n        setInputIsTouched(false)\r\n        setInput('')\r\n    }\r\n\r\n    return {\r\n        input,\r\n        inputIsValid,\r\n        inputHasError,\r\n        inputChange,\r\n        inputBlur,\r\n        reset\r\n    }\r\n}\r\n\r\nexport default useInput;","import classes from './Button.module.css';\r\n\r\nconst Button = (props) => {\r\n    return (\r\n        <button className={`${props.className} ${classes.button}`} onClick={props.onClick}>{props.children}</button>\r\n    )\r\n}\r\n\r\nexport default Button;","import classes from './Info.module.css';\r\n\r\nconst Info = (props) => {\r\n    return (\r\n        <div className={classes.info}>\r\n            {props.children}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Info;","import './App.css';\nimport mapboxgl from 'mapbox-gl';\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport React, { useRef, useEffect, useState } from 'react';\nimport mapClasses from './UI/MapContainer.module.css';\nimport inputClasses from './UI/Input.module.css';\nimport useInput from './hooks/use-input';\nimport Button from './UI/Button';\nimport Info from './UI/Info';\n\n\n\nfunction App() {\n  // input data\n  const [submitLoading, seSubmitLoading] = useState(false)\n  const [didSubmit, setDidSubmit] = useState(false)\n  const [tryAgain, setTryAgain] = useState(false)\n  const notEmpty = (value => value.length > 0)\n\n  const {\n    input: name,\n    inputIsValid: nameIsValid,\n    inputHasError: nameHasError,\n    inputChange: nameChange,\n    inputBlur: nameBlur,\n    reset: resetName\n  } = useInput(notEmpty)\n\n  const {\n    input: date,\n    inputIsValid: dateIsValid,\n    inputHasError: dateHasError,\n    inputChange: dateChange,\n    inputBlur: dateBlur,\n    reset: resetDate\n  } = useInput(notEmpty)\n\n  //map\n  const mapContainer = useRef(null);\n  const [coordinates, setCoordinates] = useState(null)\n  const [coordinatesHasError, setCoordinatesHasError] = useState(false)\n\n  mapboxgl.accessToken = 'pk.eyJ1IjoibXltYXJ5YW15ciIsImEiOiJja3cxb3ZwbmgwdzJsMzByb2FjYWIxYnR2In0.MURVRfCGZSjUP08WOTzqMA';\n\n  useEffect(() => {\n    const map = new mapboxgl.Map({\n      container: mapContainer.current,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [53.6880, 32.4279],\n      zoom: 4\n    });\n    // Add navigation control (the +/- zoom buttons)\n    map.addControl(new mapboxgl.NavigationControl(), 'top-right');\n\n    const draw = new MapboxDraw({\n      displayControlsDefault: false,\n      // mapbox-gl-draw control buttons\n      controls: {\n        polygon: true,\n        trash: true\n      },\n      // Set mapbox-gl-draw to draw by default.\n      defaultMode: 'draw_polygon'\n    });\n    map.addControl(draw);\n\n    map.on('draw.create', function (e) {\n      var x = draw.getAll();\n      setCoordinates(x['features'][0]['geometry']['coordinates'][0])\n    });\n\n    // Clean up on unmount\n    return () => map.remove();\n\n  }, [setCoordinates]);\n\n  const submitOnFirebase = (userData) => {\n    seSubmitLoading(true)\n\n    fetch(\"https://react-http-a0ffe-default-rtdb.firebaseio.com/keshtyaar.json\", {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ 'name': userData.name, 'date': userData.date, coordinates: userData.coordinates }),\n    })\n      .then(res => res.json())\n      .then(\n        () => {\n          seSubmitLoading(false)\n          setDidSubmit(true)\n        },\n        (error) => {\n          seSubmitLoading(false)\n          setTryAgain(true)\n        }\n      )\n      .catch(error => {\n        console.error('Error:', error)\n      })\n\n  }\n\n  const handleSubmit = (e) => {\n    e.preventDefault()\n    if (coordinates && nameIsValid && dateIsValid) {\n      submitOnFirebase({ name, date, coordinates })\n\n      resetName()\n      resetDate()\n    } else {\n      nameBlur()\n      dateBlur()\n      if (!coordinates) {\n        setCoordinatesHasError(true)\n      }\n      return\n    }\n  }\n  const isSubmittingForm = <Info><p>درحال ثبت درخواست ... </p></Info>\n\n  const submitedForm = (\n    <Info>\n      <p>درخواست شما با موفقیت ثبت شد</p>\n      <div>\n        <Button type=\"button\" onClick={() => window.location.reload(false)}>شروع دوباره</Button>\n      </div>\n    </Info>\n  )\n\n  const formContent = (\n    <form onSubmit={handleSubmit} className={inputClasses.form}>\n      <h1 className=\"title--big\">به کشتیار خوش آمدید!</h1>\n      <p className=\"default__p\">سلام! برای دریافت مشاوره لطفا مشخصات زمین کشاورزی خود را وارد کنید.</p>\n      <div className={inputClasses.input__block}>\n        <div className={`${inputClasses.form_group} ${nameHasError && 'invalid'}`}>\n          <label htmlFor=\"name\" className={inputClasses.control_label}>نام محصول</label>\n          <input\n            type=\"text\"\n            name=\"name\"\n            value={name}\n            onChange={nameChange}\n            onBlur={nameBlur}\n            className={inputClasses.form_control}\n          />\n          {nameHasError && <p className={inputClasses.error}>زمان کاشت نمی‌تواند خالی باشد</p>}\n        </div>\n        <div className={`${inputClasses.form_group} ${dateHasError && 'invalid'}`}>\n          <label htmlFor=\"date\" className={inputClasses.control_label}>زمان کاشت</label>\n          <input\n            type=\"date\"\n            name=\"date\"\n            value={date}\n            onChange={dateChange}\n            onBlur={dateBlur}\n            className={inputClasses.form_control}\n          />\n          {dateHasError && <p className={inputClasses.error}>نام محصول نمی‌تواند خالی باشد</p>}\n        </div>\n      </div>\n      <div className={`${mapClasses.map__block} ${coordinatesHasError && 'invalid'}`}>\n        <div className={mapClasses.description}>\n          <p>برای رسم محدوده کشاورزی خود، روی نقشه کلیک کنید.</p>\n        </div>\n        <div ref={mapContainer} className={mapClasses.mapContainer}>\n        </div>\n        {coordinatesHasError && <p className={mapClasses.error}>لطفا محدوده زمین خود را مشخص کنید</p>}\n      </div>\n      <Button type=\"submit\">ثبت اطلاعات</Button>\n    </form>\n  )\n\n  const trySubmittingAgain = (\n    <Info>\n      <p>در مرحله ثبت خطایی رخ داده است. لطفا دوباره تلاش کنید.</p>\n      <div>\n        <Button type=\"button\" onClick={() => window.location.reload(false)}>تلاش دوباره</Button>\n      </div>\n    </Info>\n  )\n\n  return (\n    <div className=\"App\">\n\n      {submitLoading && isSubmittingForm}\n      {!submitLoading && didSubmit && submitedForm}\n      {!submitLoading && !didSubmit && !tryAgain && formContent}\n      {tryAgain && trySubmittingAgain}\n\n    </div>\n  );\n\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}